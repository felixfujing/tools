webpackJsonp([4],{"9BUt":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("BcSy"),i={name:"BNodata",props:{msg:{default:"操作失败，请稍候再试或刷新",type:String},btnText:{default:"刷新",type:String},showBtn:{default:!0,type:Boolean}},methods:{handleClick:function(){this.$emit("btnClick")}}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"nodata-wrapper-container"},[n("yd-icon",{attrs:{name:"warn-outline",color:"#C0C4CC",size:"2rem"}}),t._v(" "),n("section",{staticClass:"title-container"},[t._v(t._s(t.msg))]),t._v(" "),t.showBtn?n("yd-button",{attrs:{size:"large",shape:"circle",bgcolor:"#4A5B79",color:"#fff"},nativeOn:{click:function(e){return t.handleClick(e)}}},[t._v(t._s(t.btnText)+"\n  ")]):t._e()],1)},staticRenderFns:[]};var s=n("VU/8")(i,o,!1,function(t){n("zPJJ")},"data-v-16c57834",null).exports,c=n("jkKj"),r=n.n(c),l={name:"Index",components:{BNavbar:a.a,BNodata:s},methods:{initBMap:function(){var t=this,e=new r.a.Map(document.getElementById("toilet-container")),n=new r.a.Geolocation,a=new r.a.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,offset:new BMapSub.Size(10,10)});e.addControl(a),t.bmap=e,n.getCurrentPosition(function(n){if(this.getStatus()===BMAP_STATUS_SUCCESS){var a=new r.a.Icon("https://aladdin.gosafenet.com/images/red_wz.png",new r.a.Size(32,32)),i=new r.a.Marker(n.point,{icon:a});e.addOverlay(i),e.panTo(n.point),e.centerAndZoom(n.point,18),t.point=n.point,t.handleSearchNearbyToilet(n.point)}else t.geolocationFail=!0},{enableHighAccuracy:!0,maximumAge:0})},handleSearchNearbyToilet:function(t){var e=this,n=t||e.point;e.$dialog.loading.open("搜索中");var a={pageCapacity:20,onSearchComplete:function(t){if(e.$dialog.loading.close(),i.getStatus()===BMAP_STATUS_SUCCESS){var n=[];t.forEach(function(t){for(var e=0;e<t.getCurrentNumPois();e++){var a=t.getPoi(e);n.push(a)}});var a={};(n=n.reduce(function(t,e){return!a[e.uid]&&(a[e.uid]=t.push(e)),t},[])).forEach(function(t){var n=new r.a.Icon("https://aladdin.gosafenet.com/images/blue_wz.png",new r.a.Size(32,32)),a=new r.a.Marker(t.point,{icon:n});e.bmap.addOverlay(a);var i=new r.a.Label(t.title,{offset:new r.a.Size(28,-3)});i.setStyle({borderColor:"#fff",boxShadow:".08rem .01rem .2rem #8a8a8a",borderRadius:"50px",padding:".1rem .3rem .1rem .3rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),a.setLabel(i),e.handleMarkerAddClick(t,a)})}}},i=new r.a.LocalSearch(n,a);i.searchNearby(["公厕","厕所","卫生间","洗手间"],n,2e3)},handleMarkerAddClick:function(t,e){var n=this;e.addEventListener("click",function(e){n.handleMarkerClick(t,e)})},handleMarkerClick:function(t,e){e.target;t.distance=this.bmap.getDistance(this.point,t.point).toFixed(2),this.toiletDetail=t,this.showPopup=!0}},created:function(){var t=this;this.$nextTick(function(){t.initBMap()})},data:function(){return{geolocationFail:!1,toiletDetail:"",showPopup:!1,screenHeight:window.screen.height-50,point:{}}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"toilet-wrapper-container"},[n("b-navbar",{attrs:{showLeft:!0,title:"公厕在这里"}}),t._v(" "),t.geolocationFail?n("section",[n("b-nodata",{attrs:{btnText:"重新定位"},on:{btnClick:function(e){t.location.reload()}}})],1):n("section",[n("section",{style:{width:"100%",height:t.screenHeight+"px"},attrs:{id:"toilet-container"}}),t._v(" "),n("yd-popup",{attrs:{position:"bottom",height:"30%"},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[t.toiletDetail?n("section",{staticClass:"popup-wrapper-container"},[n("section",{staticClass:"popup-title"},[n("section"),t._v(" "),n("section",{on:{click:function(e){t.showPopup=!1}}},[n("yd-icon",{attrs:{name:"error-outline",size:".4rem",color:"#999999"}})],1)]),t._v(" "),n("section",{staticClass:"popup-content"},[n("section",{staticClass:"toilet-container toilet-title"},[n("yd-icon",{staticClass:"icon",attrs:{name:"toilet",custom:"",size:".4rem",color:"#4A5B79"}}),t._v(" "),n("section",[t._v(t._s(t.toiletDetail.title))])],1),t._v(" "),n("section",{staticClass:"toilet-container address"},[n("yd-icon",{staticClass:"icon",attrs:{name:"location",size:".4rem",color:"#4A5B79"}}),t._v(" "),n("section",[t._v(t._s(t.toiletDetail.address))])],1),t._v(" "),n("section",{staticClass:"toilet-container distance"},[n("yd-icon",{staticClass:"icon",attrs:{name:"xianlu",custom:"",size:".4rem",color:"#4A5B79"}}),t._v(" "),n("section",[t._v("距您："),n("span",[t._v(t._s(t.toiletDetail.distance))]),t._v("米")])],1)])]):t._e()])],1)],1)},staticRenderFns:[]};var p=n("VU/8")(l,d,!1,function(t){n("wEPF")},"data-v-094909c6",null);e.default=p.exports},wEPF:function(t,e){},zPJJ:function(t,e){}});
//# sourceMappingURL=4.e72a24d2b32ec8829fac.js.map